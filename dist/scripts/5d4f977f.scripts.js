"use strict";angular.module("newTicApp",["firebase"]).config(["$routeProvider","$locationProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]).directive("cellBg",function(){return{restrict:"A",link:function(a,b,c){a.$watch(c.cellBg,function(a){switch(a){case"X":b.css("backgroundColor","#D1EEEE");break;case"O":b.css("backgroundColor","#DB2929");break;default:b.css("backgroundColor","#FFFFFF")}})}}}),angular.module("newTicApp").controller("MainCtrl",["$scope","$location","angularFire",function(a,b,c){var d=new Firebase("https://fire-cspears2002-newtic.firebaseio.com/queue/");a.queue={};var e=c(d,a,"queue");e.then(function(){var b=new Firebase("https://fire-cspears2002-newtic.firebaseio.com/rooms/");a.rooms={};var e=c(b,a,"rooms");e.then(function(){if(void 0==a.queue.id){console.log("I'm player 1"),a.player="p1";var c=b.push({board:[[{val:""},{val:""},{val:""}],[{val:""},{val:""},{val:""}],[{val:""},{val:""},{val:""}]],turn:"p1",moves:1,radio:1,waiting:!0,win:!1});a.roomId=c.name(),a.queue.id=a.roomId,console.log("Player 1's room is: "+a.roomId)}else console.log("I'm player 2"),a.player="p2",a.roomId=a.queue.id,a.rooms[a.roomId].waiting=!1,a.radio=a.rooms[a.roomId].turn,d.remove(),console.log("Player 2's game is: "+a.roomId);a.winStyle={},a.winStyle2={},a.resetStyle={background:"green"},a.resetVisible={view:!0},a.gameOverVisible={view:!1},a.startGame={view:!1},a.addXO=function(b,c){0==c.waiting&&a.player==c.turn&&("p1"==c.turn&&"O"!=b.val&&(b.val="X",c.radio=2),"p2"==c.turn&&"X"!=b.val&&(b.val="O",c.radio=1),c.moves++,a.identifyWin(c.board,c),c.turn="p1"==c.turn?"p2":"p1")},a.identifyWin=function(b,c){if(9==c.moves)a.winStyle=a.winStyle2={background:"#ffff11"},a.resetVisible.view=!0;else{""!=b[1][1].val&&(b[0][0].val==b[1][1].val&&b[1][1].val==b[2][2].val||b[0][2].val==b[1][1].val&&b[1][1].val==b[2][0].val)&&a.changeBgClr(c);for(var d=1;3>=d;++d)b[0][d-1].val==b[1][d-1].val&&b[1][d-1].val==b[2][d-1].val&&""!=b[0][d-1].val&&a.changeBgClr(c);for(var e=1;3>=e;++e)b[e-1][0].val==b[e-1][1].val&&b[e-1][1].val==b[e-1][2].val&&""!=b[e-1][0].val&&a.changeBgClr(c)}},a.changeBgClr=function(b){b.win=!0,"p1"==b.turn&&(a.winStyle={background:"#ffff11"},a.resetVisible.view=!0),"p2"==b.turn&&(a.winStyle2={background:"#ffff11"},a.resetVisible.view=!0)},a.pressResetButton=function(){a.resetStyle={background:"red"},a.resetVisible.view=!0},a.resetGame=function(){a.resetStyle={background:"green"},a.resetVisible.view=!1,a.winStyle={},a.winStyle2={}},a.gameOver=function(){a.resetVisible.view=!1,a.gameOverVisible.view=!0}})})}]);